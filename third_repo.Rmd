---
title: "Third Assignment"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction
The main goal of this third assignment is to gather web based data from at least two sources, merge the data sets, conduct basic descriptive and some inferential statistics on the data to address a relevant research question and briefly describe the results including with dynamically generated tables and figures. 

# Data gathering and merging process
We have gathered to different datasets from two different data sources. The first dataset is from the CIA World Fact book, and the second from the The Quality of Government Institute (QOG), which is part of the University of Gothenburg. Both datasets are open and can be found in their respective webpages.

In order to produce a tangible statistical analysis we have cleaned and merged the relevant data of both datasets. Then, we have generate tables and figures to relate the data with the aim of addressing, as well as possible, our researching question to begin to determine whether our hypothesis is correct or not.


# Tables and Figures 
In this section, we have created three different plots in order to expose in a visual way the data that we have selected to answer our research question. Two of these plots are related to education and Internet accessibility. In the first one there is a comparison between the quality of the education and internet access and the second one between average schooling year and Internet users. The third one focuses its attention on the GDP and makes and compares GDP per capita and Internet users.

In order to display, as best as possible, our data we have chosen different figures to make understandable the correlation between two different data. 
The first option chosen has been an axis with two vectors, each one representing a different variable (Internet Users, GDP per capita, Average of Schooling Years or Quality of Education). In this axis, the tendency in the correlation between the two different variables it is represented by points, each one representing a different country. Altogether, it gives a clear picture of whether there is a tendency or not that confirms the hypothesis of our researching question.  


```{r echo=false}
 library(xlsx)
Data_Education_and_Internet_Access <- read.xlsx("/Users/komaiyumi/Desktop/Social Sicence/third_repo/Education and Internet.xlsx",1)
```

# Education and Internet Accessibility
## Cleaning QOG data
```{r echo=false}

## creating plots
names(Data_Education_and_Internet_Access) <- c('Country', 'Quality_of_Education_System', 'Average_Schooling_Year','Internet_Uers')

plot(Data_Education_and_Internet_Access$'Quality_of_Education_System', Data_Education_and_Internet_Access$'Internet_Uers', xlab='Quality of education',ylab='Internet Accessibility')

plot(Data_Education_and_Internet_Access$'Average_Schooling_Year', Data_Education_and_Internet_Access$'Internet_Uers', xlab='Average Schooling Year',ylab='Internet Accessibility')
```

## Conducting hypothesis tests
```{r echo=false}
Q <- Data_Education_and_Internet_Access$'Quality_of_Education_System'
I <- Data_Education_and_Internet_Access$'Internet_Uers'
Y <- Data_Education_and_Internet_Access$'Average_Schooling_Year'
cor.test(Q,I,method="pearson")
cor.test(Y,I,method="pearson")
```

# GDP and Internet Accessibility

## Cleaning WDI data
```{r echo=false}

##Use WDI data
library("WDI", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")

indicators <- c("NY.GDP.PCAP.KD","IT.NET.USER.P3")
Data_GDPperCapita_and_Internet_Acess <- WDI(indicator=indicators, country = 'all', start = 2011, end = 2011, extra=FALSE)v


##clean data
Data_GDPperCAPITA_and_Internet_Acess <- dplyr::select(Data_GDPperCapita_and_Internet_Acess,country,NY.GDP.PCAP.KD, IT.NET.USER.P2)
ã€€
##Give new variable
names(Data_GDPperCAPITA_and_Internet_Acess) <- c('Country', 'GDPpeCapita', 'InternetUers')

```

## Conducting basic descriptive statistics
```{r echo=false}
### creating plot
plot(log(Data_GDPperCAPITA_and_Internet_Acess$'GDPperCapita'), Data_GDPperCAPITA_and_Internet_Acess$'InternetUers',xlab='Internet Users',ylab='GDP per Capita')
```

## conducting hypothesis tests
```{r echo=false}
G <- Data_GDPperCAPITA_and_Internet_Acess$'GDPperCapita'
I2 <- Data_GDPperCAPITA_and_Internet_Acess$'InternetUers'
cor.test(G,I2,method="pearson")
```
